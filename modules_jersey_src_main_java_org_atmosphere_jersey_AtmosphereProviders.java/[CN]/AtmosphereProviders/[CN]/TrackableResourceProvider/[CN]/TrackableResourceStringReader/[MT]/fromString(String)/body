{
  TrackableResource<?> trackableResource=null;
  try {
    String trackingId=req.getHeader(X_ATMOSPHERE_TRANSPORT);
    if (trackingId == null) {
      trackingId=(String)req.getAttribute(X_ATMOSPHERE_TRANSPORT);
    }
    if (trackingId != null) {
      trackableResource=TrackableSession.getDefault().lookupAndWait(trackingId);
      req.setAttribute(AtmosphereFilter.INJECTED_TRACKABLE,trackableResource);
    }
  }
 catch (  Throwable ex) {
    throw new WebApplicationException(ex);
  }
  return trackableResource;
}
