{
  if (!validFlushOrClose())   return;
  boolean b=forceAsyncIOWriter;
  try {
    writeStatusAndHeaders();
    forceAsyncIOWriter=false;
    asyncIOWriter.flush(AtmosphereResponse.this);
  }
 catch (  IOException e) {
    handleException(e);
  }
 finally {
    forceAsyncIOWriter=b;
  }
}
