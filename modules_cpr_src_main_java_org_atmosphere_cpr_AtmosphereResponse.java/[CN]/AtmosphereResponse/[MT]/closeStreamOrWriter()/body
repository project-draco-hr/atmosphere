{
  if (resource() != null && resource().transport() != AtmosphereResource.TRANSPORT.WEBSOCKET) {
    try {
      if (isUsingStream()) {
        getOutputStream().close();
      }
 else {
        getWriter().close();
      }
    }
 catch (    Exception e) {
      logger.trace("Unexpected exception",e);
    }
  }
}
