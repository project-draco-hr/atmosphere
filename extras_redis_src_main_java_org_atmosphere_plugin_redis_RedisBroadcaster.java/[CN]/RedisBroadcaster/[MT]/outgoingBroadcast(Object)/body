{
  Object lockingObject=getLockingObject();
synchronized (lockingObject) {
    if (destroyed.get()) {
      logger.debug("JedisPool closed. Re-opening");
      setID(getID());
    }
    if (sharedPool) {
      for (int i=0; i < 10; ++i) {
        boolean valid=true;
        Jedis jedis=jedisPool.getResource();
        try {
          auth(jedis);
          jedis.publish(getID(),message.toString());
        }
 catch (        JedisException e) {
          valid=false;
          logger.warn("outgoingBroadcast exception",e);
        }
 finally {
          if (valid) {
            jedisPool.returnResource(jedis);
          }
 else {
            jedisPool.returnBrokenResource(jedis);
          }
        }
        if (valid) {
          break;
        }
      }
    }
 else {
      try {
        jedisPublisher.publish(getID(),message.toString());
      }
 catch (      JedisException e) {
        logger.warn("outgoingBroadcast exception",e);
      }
    }
  }
}
