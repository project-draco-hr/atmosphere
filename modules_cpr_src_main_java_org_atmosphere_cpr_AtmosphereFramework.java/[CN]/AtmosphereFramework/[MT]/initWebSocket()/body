{
  if (webSocketProtocolInitialized)   return;
  if (webSocketProtocol == null) {
    try {
      webSocketProtocol=(WebSocketProtocol)AtmosphereFramework.class.getClassLoader().loadClass(webSocketProtocolClassName).newInstance();
      logger.info("Installed WebSocketProtocol {} ",webSocketProtocolClassName);
    }
 catch (    Exception ex) {
      logger.error("Cannot load the WebSocketProtocol {}",getWebSocketProtocolClassName(),ex);
      webSocketProtocol=new SimpleHttpProtocol();
    }
  }
  webSocketProtocolInitialized=true;
  webSocketProtocol.configure(config);
}
