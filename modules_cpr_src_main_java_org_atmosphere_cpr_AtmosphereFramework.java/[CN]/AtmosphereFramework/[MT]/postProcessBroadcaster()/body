{
  Iterator<Entry<String,AtmosphereHandlerWrapper>> i=atmosphereHandlers.entrySet().iterator();
  AtmosphereHandlerWrapper w;
  while (i.hasNext()) {
    w=i.next().getValue();
    BroadcasterConfig broadcasterConfig=new BroadcasterConfig(broadcasterFilters,config);
    if (w.broadcaster == null) {
      w.broadcaster=broadcasterFactory.lookup(w.mapping);
    }
 else {
      w.broadcaster.setBroadcasterConfig(broadcasterConfig);
      if (broadcasterCacheClassName != null) {
        BroadcasterCache cache=null;
        try {
          cache=(BroadcasterCache)Thread.currentThread().getContextClassLoader().loadClass(broadcasterCacheClassName).newInstance();
        }
 catch (        Exception ex) {
          logger.warn("",ex);
        }
        InjectorProvider.getInjector().inject(cache);
        broadcasterConfig.setBroadcasterCache(cache);
      }
    }
  }
}
