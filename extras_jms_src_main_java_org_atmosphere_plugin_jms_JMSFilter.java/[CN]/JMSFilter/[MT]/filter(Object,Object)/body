{
  if (o instanceof String) {
    String message=(String)o;
    if (!receivedMessages.remove(message)) {
      try {
        String id=bc.getID();
        if (id.startsWith("/*")) {
          id="atmosphere";
        }
        TextMessage textMessage=session.createTextMessage(message.toString());
        textMessage.setStringProperty("BroadcasterId",id);
        publisher.send(textMessage);
      }
 catch (      JMSException ex) {
        logger.warn("failed to publish message",ex);
      }
    }
    return new BroadcastAction(message);
  }
 else {
    return new BroadcastAction(o);
  }
}
