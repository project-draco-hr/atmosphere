{
  try {
    if (config.getInitParameter(JMS_TOPIC) != null) {
      topicId=config.getInitParameter(JMS_TOPIC);
    }
    if (config.getInitParameter(JNDI_NAMESPACE) != null) {
      namespace=config.getInitParameter(JNDI_NAMESPACE);
    }
    if (config.getInitParameter(JNDI_FACTORY_NAME) != null) {
      factoryName=config.getInitParameter(JNDI_FACTORY_NAME);
    }
    if (config.getInitParameter(JNDI_TOPIC) != null) {
      topicId=config.getInitParameter(JNDI_TOPIC);
    }
    logger.info("Looking up Connection Factory {}",namespace + factoryName);
    Context ctx=new InitialContext();
    ConnectionFactory connectionFactory=(ConnectionFactory)ctx.lookup(namespace + factoryName);
    logger.info("Looking up topic: {}",topicId);
    topic=(Topic)ctx.lookup(namespace + topicId);
    connection=connectionFactory.createConnection();
    consumerSession=connection.createSession(false,Session.AUTO_ACKNOWLEDGE);
    publisherSession=connection.createSession(false,Session.AUTO_ACKNOWLEDGE);
    publisher=publisherSession.createProducer(topic);
    connection.start();
    logger.info("JMS created for topic {}",topicId);
  }
 catch (  Exception e) {
    String msg="Unable to configure JMSBroadcaster";
    logger.error(msg,e);
    throw new RuntimeException(msg,e);
  }
}
