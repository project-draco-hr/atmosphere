{
  if (o instanceof String) {
    String message=(String)o;
    try {
      if (!receivedMessages.remove(message)) {
        publisher.send(session.createTextMessage(message));
      }
    }
 catch (    JMSException ex) {
      logger.warn("failed to publish message",ex);
    }
    return new BroadcastAction(message);
  }
 else {
    return new BroadcastAction(o);
  }
}
