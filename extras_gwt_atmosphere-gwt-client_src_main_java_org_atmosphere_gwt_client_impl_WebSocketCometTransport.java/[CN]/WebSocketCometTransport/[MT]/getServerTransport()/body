{
  if (transport == null) {
    transport=new ServerTransportProtocol(){
      @Override void send(      String message,      AsyncCallback<Void> callback){
        socket.send(message);
        callback.onSuccess(null);
      }
      @Override String serialize(      Object message) throws SerializationException {
        return client.getSerializer().serialize(message);
      }
    }
;
  }
  return transport;
}
