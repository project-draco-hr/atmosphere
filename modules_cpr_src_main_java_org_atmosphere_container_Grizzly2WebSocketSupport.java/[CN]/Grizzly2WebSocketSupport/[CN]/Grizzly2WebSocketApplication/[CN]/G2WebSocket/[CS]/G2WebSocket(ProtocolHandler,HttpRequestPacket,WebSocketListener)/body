{
  super(protocolHandler,request,listeners);
  Request req=Request.create();
  Response res=req.getResponse();
  req.initialize(request,protocolHandler.getFilterChainContext(),getHttpServerFilterFromChain(protocolHandler.getFilterChainContext().getFilterChain()));
  res.initialize(req,request.getResponse(),protocolHandler.getFilterChainContext(),null,null);
  servletRequest=HttpServletRequestImpl.create();
  servletResponse=HttpServletResponseImpl.create();
  try {
    WebappContext context=(WebappContext)config.getServletContext();
    servletRequest.initialize(req,servletResponse,context);
    servletResponse.initialize(res,servletRequest);
    mapRequest(context,request,servletRequest);
  }
 catch (  IOException e) {
    throw new WebSocketException("Unable to initialize WebSocket instance",e);
  }
}
