{
  if (BroadcasterFactory.class.isAssignableFrom(c.getClass())) {
    return new Injectable<BroadcasterFactory>(){
      public BroadcasterFactory getValue(){
        AtmosphereResource r=null;
        if ((Boolean)req.getAttribute(AtmosphereServlet.SUPPORT_SESSION)) {
          r=(AtmosphereResource)req.getSession().getAttribute(AtmosphereFilter.SUSPENDED_RESOURCE);
        }
        if (r == null) {
          r=(AtmosphereResource)req.getAttribute(AtmosphereServlet.ATMOSPHERE_RESOURCE);
        }
        if (r != null) {
          return r.getAtmosphereConfig().getBroadcasterFactory();
        }
 else {
          return null;
        }
      }
    }
;
  }
  return null;
}
