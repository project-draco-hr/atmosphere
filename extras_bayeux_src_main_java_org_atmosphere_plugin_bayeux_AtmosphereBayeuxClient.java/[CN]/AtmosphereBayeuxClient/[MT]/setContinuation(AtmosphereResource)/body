{
  if (continuation == null) {
synchronized (this) {
      _continuation=null;
      if (_intervalTimeoutTask != null)       _bayeux.startTimeout(_intervalTimeoutTask,_bayeux.getMaxInterval());
    }
  }
 else {
synchronized (this) {
      AtmosphereResource oldContinuation=_continuation;
      _continuation=continuation;
      _bayeux.cancelTimeout(_intervalTimeoutTask);
      _accessed=_bayeux.getNow();
      if (oldContinuation == null) {
      }
 else {
        try {
          if (oldContinuation.getAtmosphereResourceEvent().isSuspended()) {
            ((HttpServletResponse)oldContinuation.getResponse()).sendError(HttpServletResponse.SC_REQUEST_TIMEOUT);
            oldContinuation.resume();
          }
        }
 catch (        Exception e) {
          Log.debug(e);
        }
      }
    }
  }
}
