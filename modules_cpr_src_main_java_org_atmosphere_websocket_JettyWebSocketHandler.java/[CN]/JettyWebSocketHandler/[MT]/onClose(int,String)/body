{
  logger.debug("WebSocket.OnClose.");
  webSocketProcessor.notifyListener(new WebSocketEventListener.WebSocketEvent("",CLOSE,webSocketProcessor.webSocketSupport()));
  AtmosphereResource<?,?> r=(AtmosphereResource<?,?>)request.getAttribute(FrameworkConfig.ATMOSPHERE_RESOURCE);
  if (r != null) {
    r.getBroadcaster().removeAtmosphereResource(r);
  }
  webSocketProcessor.close();
}
