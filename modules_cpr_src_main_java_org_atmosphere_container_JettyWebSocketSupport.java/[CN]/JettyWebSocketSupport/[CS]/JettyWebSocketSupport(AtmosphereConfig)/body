{
  super(config);
  String[] jettyVersion=config.getServletContext().getServerInfo().substring(6).split("\\.");
  if (Integer.valueOf(jettyVersion[0]) > 7 || Integer.valueOf(jettyVersion[0]) == 7 && Integer.valueOf(jettyVersion[1]) > 4) {
    webSocketFactory=new WebSocketFactory(new WebSocketFactory.Acceptor(){
      public boolean checkOrigin(      HttpServletRequest request,      String origin){
        return true;
      }
      public WebSocket doWebSocketConnect(      HttpServletRequest request,      String protocol){
        return new JettyWebSocketHandler(request,config.getServlet(),config.getServlet().getWebSocketProcessorClassName());
      }
    }
);
    webSocketFactory.setBufferSize(4096);
    webSocketFactory.setMaxIdleTime(60000);
  }
 else {
    webSocketFactory=null;
  }
}
