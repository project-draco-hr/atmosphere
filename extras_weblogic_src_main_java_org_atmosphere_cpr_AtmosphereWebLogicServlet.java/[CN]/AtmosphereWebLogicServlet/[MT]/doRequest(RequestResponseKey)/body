{
  try {
    rrk.getRequest().getSession().setAttribute(WebLogicCometSupport.RRK,rrk);
    AtmosphereFramework.Action action=framework.doCometSupport(AtmosphereRequest.wrap(rrk.getRequest()),AtmosphereResponse.wrap(rrk.getResponse()));
    if (action.type == AtmosphereFramework.Action.TYPE.SUSPEND) {
      if (action.timeout == -1) {
        rrk.setTimeout(Integer.MAX_VALUE);
      }
 else {
        rrk.setTimeout((int)action.timeout);
      }
    }
    return action.type == AtmosphereFramework.Action.TYPE.SUSPEND;
  }
 catch (  IllegalStateException ex) {
    logger.error("AtmosphereServlet.doRequest exception",ex);
    throw ex;
  }
}
