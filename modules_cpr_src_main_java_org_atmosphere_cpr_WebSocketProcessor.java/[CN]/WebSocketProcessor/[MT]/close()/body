{
  try {
    if (handler != null && resource != null) {
      handler.onStateChange(new AtmosphereResourceEventImpl((AtmosphereResourceImpl)resource,false,true));
    }
  }
 catch (  IOException e) {
    if (AtmosphereResourceImpl.class.isAssignableFrom(resource.getClass())) {
      AtmosphereResourceImpl.class.cast(resource).onThrowable(e);
    }
    logger.info("failed invoking atmosphere handler onStateChange()",e);
  }
}
