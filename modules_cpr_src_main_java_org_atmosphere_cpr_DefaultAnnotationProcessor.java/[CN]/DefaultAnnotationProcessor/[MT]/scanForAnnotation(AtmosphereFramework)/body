{
  List<String> packages=f.customAnnotationPackages();
  AnnotationDetector detector=new AnnotationDetector(atmosphereReporter);
  try {
    if (packages.size() > 0) {
      for (      String p : packages) {
        logger.trace("Package {} scanned for @AtmosphereAnnotation",p);
        detector.detect(p);
      }
    }
    String path=f.getHandlersPath();
    if (path != null) {
      detector.detect(new File(path));
    }
    if (!coreAnnotationsFound.get()) {
      logger.warn("Unable to detect annotations. Application may to deploy.");
      for (      Class a : coreAnnotations) {
        try {
          handler.handleProcessor(loadClass(getClass(),a.getName()));
        }
 catch (        Exception e) {
          logger.trace("",e);
        }
      }
    }
  }
 catch (  IOException e) {
    logger.warn("Unable to scan annotation",e);
  }
 finally {
    detector.destroy();
  }
}
