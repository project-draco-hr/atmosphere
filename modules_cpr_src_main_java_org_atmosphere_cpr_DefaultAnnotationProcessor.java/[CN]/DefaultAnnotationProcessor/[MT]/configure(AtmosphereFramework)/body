{
  ServletContext sc=framework.getServletContext();
  Map<Class<? extends Annotation>,Set<Class<?>>> annotations=null;
  if (sc.getMajorVersion() > 2) {
    try {
      annotations=(Map<Class<? extends Annotation>,Set<Class<?>>>)sc.getAttribute(AnnotationScanningServletContainerInitializer.ANNOTATION_ATTRIBUTE);
    }
 catch (    Exception ex) {
      logger.trace("",ex);
    }
  }
  if (annotations == null) {
    delegate=new BytecodeBasedAnnotationProcessor();
  }
 else {
    delegate=new ServletContainerInitializerAnnotationProcessor(annotations,framework);
  }
  delegate.configure(framework);
  return this;
}
