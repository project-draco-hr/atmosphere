{
  this.resource=r;
  resource.addEventListener(new AtmosphereResourceEventListenerAdapter(){
    @Override public void onResume(    AtmosphereResourceEvent event){
      if (!resumed.getAndSet(true)) {
        try {
          JerseyBroadcasterUtil.broadcast(resource,new AtmosphereResourceEventImpl(resource,false,false,null).setMessage(response),resource.getBroadcaster());
        }
 catch (        Throwable t) {
          logger.trace("",t);
          try {
            resource.cancel();
          }
 catch (          IOException e) {
            logger.trace("",t);
          }
        }
      }
    }
  }
);
}
