{
  HttpServletRequest req=getWebRequestCycle().getWebRequest().getHttpServletRequest();
  Meteor meteor=Meteor.build(req);
  if (!scheduleStarted.getAndSet(true)) {
    meteor.schedule(new Callable<String>(){
      public String call(){
        String s=new Date().toString();
        return s;
      }
    }
,1);
  }
  meteor.addListener(this);
  String transport=req.getHeader(X_ATMOSPHERE_TRANSPORT);
  meteor.suspend(-1,!(transport != null && transport.equalsIgnoreCase(LONG_POLLING_TRANSPORT)));
}
