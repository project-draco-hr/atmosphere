{
  AsyncSupport cs=null;
  useServlet30Async=testClassExists(SERVLET_30);
  if (!defaultToBlocking) {
    List<Class<? extends AsyncSupport>> l=detectWebSocketPresent(useNativeIfPossible,useServlet30Async);
    if (!l.isEmpty()) {
      cs=resolveWebSocket(l);
    }
  }
  if (cs == null) {
    return new BlockingIOCometSupport(config);
  }
 else {
    return cs;
  }
}
