{
  if (cometSupport != null && AsynchronousProcessor.class.isAssignableFrom(cometSupport.getClass())) {
    ((AsynchronousProcessor)cometSupport).shutdown();
  }
  AtmosphereHandler a;
  for (  Entry<String,AtmosphereHandlerWrapper> h : atmosphereHandlers.entrySet()) {
    a=h.getValue().atmosphereHandler;
    if (a instanceof AtmosphereServletProcessor) {
      ((AtmosphereServletProcessor)a).destroy();
    }
    h.getValue().broadcaster.destroy();
  }
  if (BroadcasterFactory.getDefault() != null) {
    BroadcasterFactory.getDefault().destroy();
    BroadcasterFactory.factory=null;
  }
}
