{
  try {
    URL url=sc.getServletContext().getResource("/WEB-INF/classes/");
    URLClassLoader urlC=new URLClassLoader(new URL[]{url},Thread.currentThread().getContextClassLoader());
    loadAtmosphereDotXml(sc.getServletContext().getResourceAsStream("/META-INF/atmosphere.xml"),urlC);
    if (atmosphereHandlers.size() == 0) {
      autoDetectAtmosphereHandlers(sc.getServletContext(),urlC);
      if (atmosphereHandlers.size() == 0) {
        detectSupportedFramework(sc);
      }
      if (atmosphereHandlers.size() == 0) {
        logger.log(Level.SEVERE,"No AtmosphereHandler found. Make sure you define it inside META-INF/atmosphere.xml");
        throw new ServletException("No AtmosphereHandler found. Make sure you define it inside META-INF/atmosphere.xml");
      }
    }
  }
 catch (  Throwable t) {
    throw new ServletException(t);
  }
}
