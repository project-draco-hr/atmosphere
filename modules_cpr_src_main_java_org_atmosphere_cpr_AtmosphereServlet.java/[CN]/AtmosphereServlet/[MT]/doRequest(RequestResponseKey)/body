{
  try {
    rrk.getRequest().getSession().setAttribute(WebLogicCometSupport.RRK,rrk);
    Action action=doCometSupport(rrk.getRequest(),rrk.getResponse());
    if (action.type == Action.TYPE.SUSPEND) {
      if (action.timeout == -1) {
        rrk.setTimeout(Integer.MAX_VALUE);
      }
 else {
        rrk.setTimeout((int)action.timeout);
      }
    }
    return action.type == Action.TYPE.SUSPEND;
  }
 catch (  IllegalStateException ex) {
    logger.log(Level.SEVERE,"AtmosphereServlet.doRequest exception",ex);
    throw ex;
  }
}
