{
  if (framework == null) {
    if (sc.getServletContext().getMajorVersion() > 2) {
      try {
        framework=(AtmosphereFramework)sc.getServletContext().getAttribute(sc.getServletContext().getServletRegistration(sc.getServletName()).getName());
      }
 catch (      Exception ex) {
        if (UnsupportedOperationException.class.isAssignableFrom(ex.getClass())) {
          logger.warn("WebLogic 12c unable to retrieve Servlet. Please make sure your servlet-name to 'AtmosphereServlet'");
          framework=(AtmosphereFramework)sc.getServletContext().getAttribute(AtmosphereServlet.class.getSimpleName());
        }
 else {
          logger.trace("",ex);
        }
      }
    }
    if (framework == null) {
      framework=newAtmosphereFramework();
    }
  }
  framework.init(sc);
  return this;
}
