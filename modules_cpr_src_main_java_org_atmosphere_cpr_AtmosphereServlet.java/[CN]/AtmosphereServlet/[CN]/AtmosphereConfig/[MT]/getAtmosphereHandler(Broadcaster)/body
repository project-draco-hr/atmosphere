{
  AtmosphereHandler h=atmosphereHandlers.get(bc.getID()).atmosphereHandler;
  if (h == null) {
    for (    AtmosphereHandlerWrapper ah : atmosphereHandlers.values()) {
      if (ah.broadcaster == bc) {
        atmosphereHandlers.put(bc.getID(),ah);
        return ah.atmosphereHandler;
      }
    }
    throw new IllegalStateException("Unable to find associated AtmosphereHandler");
  }
 else {
    return h;
  }
}
