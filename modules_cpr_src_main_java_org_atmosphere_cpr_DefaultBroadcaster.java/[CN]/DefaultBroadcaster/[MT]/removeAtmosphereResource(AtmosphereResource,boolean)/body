{
  if (destroyed.get()) {
    logger.debug(DESTROYED,getID(),"removeAtmosphereResource(AtmosphereResource r)");
    return this;
  }
  if (executeDone) {
    BroadcasterFuture f=(BroadcasterFuture)r.getRequest().getAttribute(getID());
    if (f != null) {
      r.getRequest().removeAttribute(getID());
      f.done();
    }
  }
  resources.remove(r);
  if (resources.isEmpty()) {
    notifyEmptyListener();
    if (scope != SCOPE.REQUEST && lifeCyclePolicy.getLifeCyclePolicy() == EMPTY) {
      releaseExternalResources();
    }
 else     if (scope == SCOPE.REQUEST || lifeCyclePolicy.getLifeCyclePolicy() == EMPTY_DESTROY) {
      BroadcasterFactory.getDefault().remove(this,name);
      destroy();
    }
  }
  return this;
}
