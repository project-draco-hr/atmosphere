{
  this.scope=scope;
  try {
    if (scope == SCOPE.REQUEST) {
      for (      AtmosphereResource<?,?> r : resources) {
        Broadcaster b=BroadcasterFactory.getDefault().get(this.getClass(),this.getClass().getSimpleName() + "/" + UUID.randomUUID());
        if (DefaultBroadcaster.class.isAssignableFrom(this.getClass())) {
          DefaultBroadcaster.class.cast(b).broadcasterCache=bc.getBroadcasterCache().getClass().newInstance();
        }
        r.setBroadcaster(b);
        if (r.getAtmosphereResourceEvent().isSuspended()) {
          b.addAtmosphereResource(r);
        }
      }
      if (!resources.isEmpty()) {
        this.destroy();
      }
    }
  }
 catch (  Exception e) {
    LoggerUtils.getLogger().log(Level.SEVERE,"",e);
  }
}
