{
  if (!bc.getBroadcasterCache().getClass().equals(BroadcasterConfig.DefaultBroadcasterCache.class.getName())) {
    if (r.isResumed() || r.isCancelled()) {
      BroadcasterCache broadcasterCache=bc.getBroadcasterCache();
      if (!UUIDBroadcasterCache.class.isAssignableFrom(broadcasterCache.getClass())) {
        trackBroadcastMessage(r,entry);
      }
      return;
    }
  }
  BlockingQueue<AsyncWriteToken> queue=writeQueues.get(r.uuid());
  if (queue == null) {
    queue=new LinkedBlockingQueue<AsyncWriteToken>();
    writeQueues.put(r.uuid(),queue);
    bc.getAsyncWriteService().submit(getAsyncWriteHandler(queue));
  }
  queue.put(new AsyncWriteToken(r,finalMsg,entry.future,entry.originalMessage,entry.cache));
}
