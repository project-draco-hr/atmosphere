{
  String name=super.getHeader(s);
  if (name == null) {
    if (b.headers.get(s) != null) {
      return b.headers.get(s);
    }
    if (s.startsWith(X_ATMOSPHERE) && b.request != null) {
      name=(String)b.request.getAttribute(s);
    }
  }
  if (name == null) {
    if ("content-type".equalsIgnoreCase(s)) {
      return contentType;
    }
 else     if ("connection".equalsIgnoreCase(s)) {
      return "keep-alive";
    }
  }
  if (name == null && checkCase) {
    return getHeader(s.toLowerCase(),false);
  }
  return name;
}
