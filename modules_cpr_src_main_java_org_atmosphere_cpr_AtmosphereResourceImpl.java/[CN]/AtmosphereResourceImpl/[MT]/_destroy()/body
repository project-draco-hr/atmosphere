{
  try {
    if (!isCancelled.get()) {
      if (broadcaster != null)       broadcaster.removeAtmosphereResource(this);
      if (config.getBroadcasterFactory() != null) {
        config.getBroadcasterFactory().removeAllAtmosphereResource(this);
      }
    }
    unregister();
    removeEventListeners();
  }
 catch (  Throwable t) {
    logger.trace("destroyResource",t);
  }
 finally {
    unregister();
    webSocket=null;
  }
}
