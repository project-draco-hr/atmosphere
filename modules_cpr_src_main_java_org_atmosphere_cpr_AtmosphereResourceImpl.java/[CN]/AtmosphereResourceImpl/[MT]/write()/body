{
  if (beginCompatibleData == null) {
    beginCompatibleData=createStreamingPadding(padding);
  }
  try {
    if (useWriter && !((Boolean)req.getAttribute(ApplicationConfig.PROPERTY_USE_STREAM))) {
      try {
        response.getWriter();
      }
 catch (      IllegalStateException e) {
        return;
      }
      response.getWriter().write(beginCompatibleData);
      response.getWriter().flush();
    }
 else {
      try {
        response.getOutputStream();
      }
 catch (      IllegalStateException e) {
        return;
      }
      response.getOutputStream().write(beginCompatibleData.getBytes());
      response.getOutputStream().flush();
    }
  }
 catch (  Throwable ex) {
    logger.warn("failed to write to response",ex);
  }
}
