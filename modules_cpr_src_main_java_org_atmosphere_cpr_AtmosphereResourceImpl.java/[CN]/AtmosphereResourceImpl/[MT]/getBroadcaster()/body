{
  if (broadcaster == null) {
    throw new IllegalStateException("No Broadcaster associated with this AtmosphereResource.");
  }
  String s=config.getInitParameter(ApplicationConfig.RECOVER_DEAD_BROADCASTER);
  boolean autoCreate=true;
  if (s != null) {
    autoCreate=Boolean.parseBoolean(s);
  }
  if (autoCreate && broadcaster.isDestroyed()) {
    logger.warn("The current Broadcaster has been destroyed and cannot be re-used. Recreating a new one with the same name. You can turn off that" + " mechanism by adding, in web.xml, " + ApplicationConfig.RECOVER_DEAD_BROADCASTER + " set to false");
synchronized (this) {
      String id=broadcaster.getScope() != Broadcaster.SCOPE.REQUEST ? broadcaster.getID() : broadcaster.getID() + ".recovered" + UUID.randomUUID();
      broadcaster=BroadcasterFactory.getDefault().get(id);
      broadcaster.addAtmosphereResource(this);
    }
  }
  return broadcaster;
}
