{
  super.action(r);
  ServletRequest request=r.getRequest();
  while (!AtmosphereRequest.class.isAssignableFrom(request.getClass())) {
    request=AtmosphereRequest.class.cast(request).getRequest();
  }
  Continuation c=(Continuation)request.getAttribute(Continuation.class.getName());
  if (c != null) {
    try {
      if (c.isSuspended()) {
        c.complete();
      }
    }
 catch (    IllegalStateException ex) {
      logger.trace("c.complete()",ex);
    }
 finally {
      r.getRequest().setAttribute(FrameworkConfig.CANCEL_SUSPEND_OPERATION,true);
    }
    request.removeAttribute(Continuation.class.getName());
  }
}
