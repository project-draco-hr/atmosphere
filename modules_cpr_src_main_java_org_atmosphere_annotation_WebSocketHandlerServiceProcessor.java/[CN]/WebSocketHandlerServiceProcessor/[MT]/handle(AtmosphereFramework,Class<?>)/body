{
  try {
    Class<WebSocketHandler> s=(Class<WebSocketHandler>)annotatedClass;
    WebSocketHandlerService m=s.getAnnotation(WebSocketHandlerService.class);
    framework.addAtmosphereHandler(m.path(),AtmosphereFramework.REFLECTOR_ATMOSPHEREHANDLER).initWebSocket();
    atmosphereConfig(m.atmosphereConfig(),framework);
    framework.setDefaultBroadcasterClassName(m.broadcaster().getName());
    filters(m.broadcastFilters(),framework);
    interceptors(m.interceptors(),framework);
    AtmosphereInterceptor aa=listeners(m.listeners(),framework);
    if (aa != null) {
      framework.interceptor(aa);
    }
    WebSocketProcessor p=WebSocketProcessorFactory.getDefault().getWebSocketProcessor(framework);
    p.registerWebSocketHandler(m.path(),new WebSocketProcessor.WebSocketHandlerProxy(broadcasterClass(framework,m.broadcaster()),framework.newClassInstance(s)));
  }
 catch (  Throwable e) {
    logger.warn("",e);
  }
}
