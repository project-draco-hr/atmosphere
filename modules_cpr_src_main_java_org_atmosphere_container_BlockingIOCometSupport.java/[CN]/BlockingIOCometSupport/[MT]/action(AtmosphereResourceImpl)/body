{
  try {
    super.action(r);
    if (r.action().type() == Action.TYPE.RESUME) {
      AtmosphereRequest req=r.getRequest(false);
      CountDownLatch latch=null;
      if (req.getAttribute(LATCH) != null) {
        latch=(CountDownLatch)req.getAttribute(LATCH);
      }
      String s=config.getInitParameter(ApplicationConfig.RESUME_AND_KEEPALIVE);
      if (latch != null && (s == null || s.equalsIgnoreCase("false"))) {
        latch.countDown();
      }
 else       if (req.getAttribute(AtmosphereResourceImpl.PRE_SUSPEND) == null) {
        logger.error("Unable to resume the suspended connection");
      }
    }
  }
 catch (  Exception ex) {
    logger.error("",ex);
  }
}
