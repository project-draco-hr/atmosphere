{
  boolean acquired=false;
  try {
    acquired=semaphore.tryAcquire(writeTimeout,TimeUnit.MILLISECONDS);
    if (acquired) {
      ByteBuffer b=ByteBuffer.wrap(data,offset,length);
      session.getAsyncRemote().sendBinary(ByteBuffer.wrap(data,offset,length),new WriteResult(resource(),b.array()));
    }
 else {
      logger.warn("Timeout while waiting until socket is available, message will be lost");
    }
  }
 catch (  Throwable e) {
    handleError(e,acquired);
  }
  return this;
}
