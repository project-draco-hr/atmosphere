{
  try {
    semaphore.acquireUninterruptibly();
    session.getAsyncRemote().sendText(s,new WriteResult(resource(),s));
  }
 catch (  NullPointerException e) {
    patchGlassFish(e);
    semaphore.release();
  }
catch (  RuntimeException e) {
    semaphore.release();
    throw e;
  }
  return this;
}
