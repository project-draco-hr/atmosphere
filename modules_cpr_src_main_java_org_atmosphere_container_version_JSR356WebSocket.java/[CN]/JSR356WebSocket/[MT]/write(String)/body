{
  boolean acquired=false;
  try {
    acquired=semaphore.tryAcquire(writeTimeout,TimeUnit.MILLISECONDS);
    if (acquired) {
      session.getAsyncRemote().sendText(s,new WriteResult(resource(),s));
    }
 else {
      logger.warn("Timeout while waiting until socket is available, message {} will be lost",s);
    }
  }
 catch (  Throwable e) {
    handleError(e,acquired);
  }
  return this;
}
