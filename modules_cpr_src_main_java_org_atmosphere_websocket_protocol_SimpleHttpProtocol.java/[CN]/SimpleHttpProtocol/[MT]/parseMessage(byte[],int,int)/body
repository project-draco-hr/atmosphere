{
  try {
    String pathInfo=request().getPathInfo();
    if (d[0] == (byte)delimiter.charAt(0) && d[1] == (byte)delimiter.charAt(0)) {
      final String s=new String(d,offset,length,"UTF-8");
      String[] token=s.split(delimiter);
      pathInfo=token[1];
      d=token[2].getBytes("UTF-8");
    }
    WebSocketHttpServletRequest r=new WebSocketHttpServletRequest.Builder().request(request()).method(methodType).contentType(contentType).body(d,offset,length).pathInfo(pathInfo).headers(configureHeader(request())).build();
    atmosphereServlet().doCometSupport(r,new WebSocketHttpServletResponse<WebSocket>(webSocketSupport()));
  }
 catch (  IOException e) {
    logger.warn(e.getMessage(),e);
  }
catch (  ServletException e) {
    logger.warn(e.getMessage(),e);
  }
}
