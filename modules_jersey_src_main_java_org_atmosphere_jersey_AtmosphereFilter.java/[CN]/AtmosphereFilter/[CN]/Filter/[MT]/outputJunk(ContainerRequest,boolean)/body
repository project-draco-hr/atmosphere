{
  boolean webSocketEnabled=false;
  if (servletReq.getHeaders("Connection") != null && servletReq.getHeaders("Connection").hasMoreElements()) {
    String[] e=((Enumeration<String>)servletReq.getHeaders("Connection")).nextElement().split(",");
    for (    String upgrade : e) {
      if (upgrade.trim().equalsIgnoreCase("Upgrade")) {
        webSocketEnabled=true;
        break;
      }
    }
  }
  String transport=request.getHeaderValue("X-Atmosphere-Transport");
  if (webSocketEnabled) {
    return false;
  }
 else   if (transport != null && transport.equals("long-polling")) {
    return false;
  }
  return outputJunk;
}
