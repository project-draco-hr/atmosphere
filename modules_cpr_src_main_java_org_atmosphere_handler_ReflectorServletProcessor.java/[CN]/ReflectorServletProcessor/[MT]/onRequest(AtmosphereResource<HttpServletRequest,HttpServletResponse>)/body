{
  r.getRequest().setAttribute(AtmosphereServlet.ATMOSPHERE_RESOURCE,r);
  r.getRequest().setAttribute(AtmosphereServlet.ATMOSPHERE_HANDLER,this);
  try {
    wrapper.service(r.getRequest(),r.getResponse());
  }
 catch (  Throwable ex) {
    logger.error("onRequest()",ex);
    throw new RuntimeException(ex);
  }
}
