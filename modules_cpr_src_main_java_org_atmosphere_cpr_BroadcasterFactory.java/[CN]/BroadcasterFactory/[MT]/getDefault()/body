{
  if (factory == null) {
    Class<? extends Broadcaster> b=null;
    try {
      ClassLoader cl=Thread.currentThread().getContextClassLoader();
      b=(Class<? extends Broadcaster>)cl.loadClass(AtmosphereServlet.getDefaultBroadcasterClassName());
    }
 catch (    ClassNotFoundException e) {
      LoggerUtils.getLogger().log(Level.SEVERE,"",e);
    }
    factory=new DefaultBroadcasterFactory(b == null ? DefaultBroadcaster.class : b);
  }
  return factory;
}
