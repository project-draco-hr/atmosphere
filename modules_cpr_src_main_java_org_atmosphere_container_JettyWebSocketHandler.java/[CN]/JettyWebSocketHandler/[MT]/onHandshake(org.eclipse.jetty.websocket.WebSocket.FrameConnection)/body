{
  logger.trace("WebSocket.onHandshake");
  try {
    webSocketProcessor=new WebSocketProcessor(atmosphereServlet,new Jetty8WebSocket(connection,atmosphereServlet.getAtmosphereConfig()),webSocketProtocol);
  }
 catch (  Exception e) {
    logger.warn("failed to connect to web socket",e);
  }
  webSocketProcessor.notifyListener(new WebSocketEventListener.WebSocketEvent("",HANDSHAKE,webSocketProcessor.webSocket()));
}
